# Basic Pentesting Machine from Try Hack Me

## Nmap
`nmap -sVC <targetipaddress>`

Ports:
22
80
And a couple of samba ports that are open. (139, 445)

## HTTP
First I take a look at the http port and head over to the webpage.

Did not get much from the inspect tool.
Checked for /robots.txt and /admin. 

## gobuster
`gobuster -u http://<targetipaddress> -w /usr/share/SecLists/Discovery/Web-Content/common.txt`

Results:
/.htpasswd            (Status: 403) [Size: 297]
/.htaccess            (Status: 403) [Size: 297]
/.hta                 (Status: 403) [Size: 292]
/development          (Status: 301) [Size: 320] [--> http://10.10.235.114/development/]
/index.html           (Status: 200) [Size: 158]
/server-status        (Status: 403) [Size: 301]

From here I checked out the /development directory 
checked both **dev.txt** and **j.txt**; j.txt we can see J talking to K and we notice that Kk has a weak password that we can use to find and take advantage of. 

Users:
J adn K are the two users we know exist in the machine thus far. Can use samaba to confirm this and get the usernames.

## [samba](https://github.com/mksiki/notes/blob/main/samba.md)
`/usr/share/enum4linux/enum4linux.pl -a 10.10.235.114 `

Results:
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)

## hydra 
`hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.235.114`

Results:
[22][ssh] host: 10.10.235.114   login: jan   password: armando

## SSH

While in SSH most of the stuff I did not have permssion to read and nothing of use. 
I did find another directory in /home, **kay**. 
Had a pass.bk files that I did not have permission to **cat**. Other files were the same.

To escalte this procces I will use linpeas.

### LinPEAS (Linux Privilege Escalation Awesome Script)
First I coped the linpeas.sh to **jan** machine. 
`scp ./linpeas.sh jan@<targetipaddress>:/dev/shm`

From Jan's computer:
`cd /dev/shm`
`./linpeas.sh`

Results:
══╣ Possible private SSH keys were found!
/home/kay/.ssh/id_rsa

under **kay** /.ssh directory they have an SSH key that we can use to login using that user. 

`cd /home/kay/.ssh/`
`cat id_rsa`

Copy and paste that into my macine using vim and saving it(`chmod 600 kay_id_rsa`). 

### SSH kay's machine

Prompted to enter passphrase for **kay's** key. 

To figure out this passphrase I used JohnTheRipper. 

John the Ripper can crack an SSH key passphrase by first converting the private key into a 
format John understands using ssh2john and then running a brute-force or wordlist attack.

Save the hash key to a format John undesrtands:
`/usr/share/john/ssh2john.py kay_id_rsa > key.txt`

Run `john --wordlist=/usr/share/wordlists/rockyou.txt key.txt` 

Results:
beeswax          (kay_id_rsa)

`ssh -i kay_id_rsa kay@<targetipaddress>`

Entered passphrase:
`ls`
`cat pass.bak`

# Summary of the Pentesting Walkthrough  

This TryHackMe walkthrough focuses on a basic penetration testing process, highlighting key techniques and tools to identify vulnerabilities and escalate privileges on a target machine. The approach emphasizes the importance of proper **enumeration, exploitation, and privilege escalation** strategies.

### Key Concepts and Takeaways:

1. **Enumeration is Crucial**:  
   The first phase of penetration testing is gathering information about the target. Tools like **Nmap** and **gobuster** help identify open ports and directories, which can reveal hidden entry points. In this case, **Nmap** revealed open ports (SSH, HTTP, Samba), and **gobuster** helped uncover a `/development` directory containing crucial user information. This phase allows testers to map out the target and look for weak points.

2. **Identifying Users with Samba**:  
   **Samba** can expose usernames and other information about a machine. Using tools like **enum4linux**, testers can enumerate users on the target system, making it easier to focus brute-force attacks and potentially identify accounts with weak passwords. In this walkthrough, the two main users discovered were **jan** and **kay**, both of whom became targets for further exploitation.

3. **Exploitation with Brute-Forcing**:  
   Once potential usernames are identified, brute-forcing is used to guess passwords. **Hydra**, a popular tool for this, was used to crack the SSH password for **jan**, giving access to the target system. This highlights the importance of password security, as weak passwords can be easily exploited.

4. **Privilege Escalation**:  
   After gaining access to a low-privileged account, the next step is to look for ways to escalate privileges. In this case, the tester found an **SSH private key** belonging to **kay** in her home directory, which could be used to authenticate as **kay**. However, the private key was protected by a passphrase, which was cracked using **JohnTheRipper**. This demonstrates the importance of protecting sensitive keys with strong passphrases.

5. **Automation and Scripts**:  
   The use of automated tools like **LinPEAS** (a Linux privilege escalation script) made it easier to identify weaknesses and find sensitive files or misconfigurations. The combination of manual exploration and automated scripts is essential in real-world pentesting engagements, as it speeds up the process and uncovers hidden vulnerabilities.

### What to Remember:
- **Enumeration** is key: Tools like **Nmap** and **gobuster** allow you to discover open ports and hidden directories.
- **User enumeration** (e.g., with **enum4linux**) helps identify valid usernames to target.
- **Brute-force** attacks (using **hydra**) can crack weak passwords and provide entry to systems.
- **Privilege escalation** can often be achieved by finding SSH keys or other sensitive files; tools like **LinPEAS** and **JohnTheRipper** can help in these situations.
- The process involves both **manual checks** and the use of **automated scripts** to speed up discovery and exploitation.



